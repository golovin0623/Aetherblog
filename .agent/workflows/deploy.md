---
description: æ„å»ºå¹¶å‘å¸ƒæ–°ç‰ˆæœ¬ Docker é•œåƒåˆ° Docker Hubï¼Œè‡ªåŠ¨ç”Ÿæˆç‰ˆæœ¬æ€»ç»“
---

# Deploy å·¥ä½œæµ - æ„å»ºå‘å¸ƒæ–°ç‰ˆæœ¬

æ­¤å·¥ä½œæµç”¨äºæ„å»º Docker é•œåƒå¹¶æ¨é€åˆ° Docker Hubï¼ŒåŒæ—¶ç”Ÿæˆç‰ˆæœ¬å‘å¸ƒæ€»ç»“ã€‚æè¿°å’Œæäº¤å†…å®¹ä»¥åŠå¯¹ç”¨æˆ·çš„æ±‡æŠ¥å¿…é¡»ç”¨ç²¾å‡†çš„ä¸­æ–‡æè¿°ã€‚

## å‰ç½®æ¡ä»¶

1. Docker Desktop æ­£åœ¨è¿è¡Œ
2. å·²ç™»å½• Docker Hub (`docker login`)
3. æ‰€æœ‰ä»£ç æ›´æ”¹å·²æäº¤åˆ° Git

## å·¥ä½œæµæ­¥éª¤

### 1. æ£€æŸ¥å½“å‰æœ€æ–°ç‰ˆæœ¬

// turbo
```bash
curl -s "https://hub.docker.com/v2/repositories/golovin0623/aetherblog-backend/tags/?page_size=5" 2>/dev/null | grep -o '"name":"v[^"]*"' | head -3
```

æ ¹æ®è¿”å›ç»“æœç¡®å®šæ–°ç‰ˆæœ¬å·ï¼ˆå½“å‰æœ€æ–°ç‰ˆæœ¬ +1ï¼‰ã€‚

### 2. ç¡®è®¤ Git çŠ¶æ€

// turbo
```bash
git status --short
```

å¦‚æœæœ‰æœªæäº¤çš„æ›´æ”¹ï¼Œå…ˆæ£€æŸ¥æ‰€æœ‰å·²ä¿®æ”¹çš„ä»£ç ï¼Œç”Ÿæˆå¾…æäº¤çš„ä»£ç æ”¹åŠ¨æ‘˜è¦ï¼›
ç„¶åå…ˆæ‰§è¡Œ `git add . && git commit -m "your message"`ã€‚

### 3. [å…³é”®!] ç”¨æˆ·ç¡®è®¤
**STOP!** è¯·åœ¨æ­¤æ­¥éª¤æš‚åœï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤ï¼Œæä¾›ç»™ç”¨æˆ·æœ¬æ¬¡å³å°†æäº¤çš„æ‘˜è¦å†…å®¹ã€‚

åœ¨æ‰§è¡Œæ„å»ºä¹‹å‰ï¼Œ**å¿…é¡»**å‘ç”¨æˆ·æ±‡æŠ¥ä»¥ä¸‹ä¿¡æ¯å¹¶è¯·æ±‚æ‰¹å‡†ï¼š
1. **å½“å‰æœ€æ–°ç‰ˆæœ¬**: (ä»æ­¥éª¤ 1 è·å–)
2. **è®¡åˆ’å‘å¸ƒç‰ˆæœ¬**: (å»ºè®®ç‰ˆæœ¬å·ï¼Œå¦‚ v1.1.6 -> v1.1.7)
3. **åŒ…å«çš„å˜æ›´**: (ç®€è¿°æ­¥éª¤ 2 ä¸­çš„ commit è®°å½•)
4. æœ¬æ¬¡æ”¹åŠ¨çš„ä»£ç å†…å®¹æ¶‰åŠå‡ ä¸ªæ¨¡å—ï¼Œå³å°†éƒ¨ç½²å‘å¸ƒå“ªä¸ªæ¨¡å—çš„æ›´æ–°é•œåƒæˆ–è€…æ˜¯å…¨éƒ¨é•œåƒ

**ä»…å½“ç”¨æˆ·å›å¤ "ç¡®è®¤"ã€"æ‰¹å‡†" æˆ– "/approve" æ—¶ï¼Œæ‰ç»§ç»­æ‰§è¡Œæ­¥éª¤ 4ã€‚**

### 4. æ„å»ºå¹¶æ¨é€ Docker é•œåƒ

å°† `VERSION` æ›¿æ¢ä¸ºæ–°ç‰ˆæœ¬å·
å°åŠŸèƒ½ä¿®å¤ï¼ˆå¦‚ v1.1.3 -> v1.1.4ï¼‰
å¤§åŠŸèƒ½æ–°å¢ï¼ˆå¦‚ v1.1.3 -> v1.2.1ï¼‰
å¤§ç‰ˆæœ¬è¿­ä»£ï¼ˆå¦‚ v1.1.3 -> v2.0.0ï¼‰ï¼š

è¯·åˆ†æä¿®æ”¹ä»£ç çš„æ¶‰åŠæ¨¡å—ï¼Œä»è€Œå†³å®šæ˜¯éƒ¨åˆ†æ„å»ºè¿­ä»£æ¨é€ï¼Œè¿˜æ˜¯å…¨é¢çš„çš„æ„å»ºæ¨é€
ä¾‹å¦‚ï¼Œæ‰€æœ‰æ¨¡å—ä»£ç å‡å­˜åœ¨å˜æ›´ï¼Œåˆ™æ‰§è¡Œä¸‹è¿°å…¨é¢æ„å»ºæŒ‡ä»¤ï¼š

```bash
./docker-build.sh --push --version VERSION
```

åˆ†æè®¤å®šä¸ºéƒ¨åˆ†æ„å»ºï¼Œä¾‹å¦‚ï¼š
```bash
./docker-build.sh --only admin --only blog --push --version v2.3.2
```

æ­¤å‘½ä»¤ä¼šï¼š
- å¹¶è¡Œæ„å»º 3 ä¸ªé•œåƒ (backend, blog, admin)
- æ”¯æŒå¤šå¹³å° (linux/amd64, linux/arm64)
- è‡ªåŠ¨æ¨é€åˆ° Docker Hub

### 4. ç”Ÿæˆç‰ˆæœ¬æ€»ç»“

æŸ¥çœ‹è‡ªä¸Šæ¬¡å‘å¸ƒä»¥æ¥çš„æ‰€æœ‰æäº¤ï¼š

// turbo
```bash
git log --oneline origin/main..HEAD
```

æ ¹æ®æäº¤è®°å½•ç”Ÿæˆç‰ˆæœ¬æ€»ç»“ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```markdown
## vX.X.X ç‰ˆæœ¬æ›´æ–°

### ğŸ› Bug Fixes
- [ä¿®å¤å†…å®¹1]
- [ä¿®å¤å†…å®¹2]

### âœ¨ Features  
- [æ–°åŠŸèƒ½1]
- [æ–°åŠŸèƒ½2]

### ğŸ”§ Improvements
- [ä¼˜åŒ–å†…å®¹1]
- [ä¼˜åŒ–å†…å®¹2]
```

### 5. æœåŠ¡å™¨éƒ¨ç½²å‘½ä»¤

æ„å»ºå®Œæˆåï¼Œè‹¥ç”¨æˆ·æœ‰éœ€è¦ï¼Œåˆ™åœ¨æœåŠ¡å™¨æ‰§è¡Œï¼š

```bash
export DOCKER_REGISTRY=golovin0623
export VERSION=latest
docker-compose -f docker-compose.prod.yml pull
docker-compose -f docker-compose.prod.yml up -d
```

## å¿«é€Ÿå‘½ä»¤å‚è€ƒ

| å‘½ä»¤ | è¯´æ˜ |
|:-----|:-----|
| `./docker-build.sh --push --version vX.X.X` | æ„å»ºå¹¶æ¨é€æŒ‡å®šç‰ˆæœ¬ |
| `./docker-build.sh --only backend --push` | åªæ„å»ºåç«¯ |
| `./docker-build.sh --only blog --push` | åªæ„å»ºåšå®¢å‰ç«¯ |
| `./docker-build.sh --only admin --push` | åªæ„å»ºç®¡ç†åå° |
| `./docker-build.sh --sequential --push` | ä¸²è¡Œæ„å»ºï¼ˆç½‘ç»œä¸ç¨³å®šæ—¶ä½¿ç”¨ï¼‰ |

## æ³¨æ„äº‹é¡¹

- ç‰ˆæœ¬å·æ ¼å¼ï¼š`vX.Y.Z`ï¼ˆå¦‚ v1.1.3ï¼‰
- æ„å»ºæ—¶é—´çº¦ 2-3 åˆ†é’Ÿï¼ˆå–å†³äºç½‘ç»œå’Œç¼“å­˜ï¼‰
- å¦‚é‡æ„å»ºå¤±è´¥ï¼Œæ£€æŸ¥ Docker ç™»å½•çŠ¶æ€å’Œç½‘ç»œè¿æ¥