id,priority,phase,area,title,description,acceptance_criteria,test_mcp,review_initial_requirements,review_regression_requirements,dev_state,review_initial_state,review_regression_state,git_state,owner,refs,notes
AIOB-000,P0,1,both,建立 AI 统计故障基线与验收口径,归档请求失败、空数据、静默降级、配置错误四类样本，并沉淀统一指标口径。基线作为后续修复和发布准入的唯一判据。,至少形成4类故障样本清单；定义看板可用率、日志接口成功率、空数据误判率三项指标；提供可复测步骤并完成一次复跑。,AUTOE2E,Review需确认样本覆盖 Admin、Server、AI Service 三段链路且指标可量化；禁止仅凭主观“看起来正常”。,回归需按同一清单逐项复测并记录结果；指标口径变更必须附变更原因与影响范围。,已完成,已完成,已完成,已提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:16;plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:13;apps/admin/src/services/analyticsService.ts:156;apps/admin/src/pages/dashboard/DashboardPage.tsx:149;docs/qa/ai-analytics-observability-baseline-2026-02-13.md:1,picked_reason:优先建立统一故障样本与指标口径，作为后续P0修复和回归的验收基线。; review_initial:样本覆盖 Admin/Server/AI Service 三段链路，3项指标均可量化; validation_limited:AUTOE2E 需全栈联调与浏览器环境，当前仅完成静态链路复核; manual_test:./start.sh 后登录 Admin Dashboard，按文档第4节逐项复测 F001~F004 并记录指标; evidence:新增基线文档+执行 pnpm --filter @aetherblog/admin build + rg 故障锚点检索; risk:medium 未执行真实端到端联调流量回放，需在集成环境补测; done_at:2026-02-13
AIOB-010,P0,2,both,完成 Admin 到服务端到 AI 的契约审计,核对参数、分页、响应结构与错误码语义，收敛为单一契约清单并消除接口语义歧义。,产出一份契约表覆盖100% AI 统计与日志相关接口；字段命名、分页语义、错误分类在三端保持一致；发现差异均有处理结论。,AUTOE2E,Review需逐接口对照前端调用与后端签名，确认可空字段与默认值策略，避免“200但data语义不一致”。,回归需使用契约清单抽样联调，至少覆盖正常、空结果、参数非法、鉴权失败四类路径。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:17;apps/admin/src/services/analyticsService.ts:156;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/controller/StatsController.java:87;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/service/StatsService.java:89;apps/ai-service/app/api/routes/ai.py:64,
AIOB-020,P0,3,backend,修复配置链与路由可达性自检,统一 AI 服务地址、Profile 加载、网关前缀与鉴权头传递，并在启动期增加关键依赖自检。,部署后关键接口健康检查通过率100%；base-url、前缀、鉴权配置异常可在启动或预检阶段被阻断并输出明确错误。,AUTOSERVER,Review需确认配置来源优先级与环境覆盖规则，避免多环境配置漂移；错误日志需包含可定位字段。,回归需在 dev/staging 至少两套配置执行 preflight；模拟错误配置并验证阻断与告警行为。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:18;apps/server/aetherblog-ai/ai-client/src/main/java/com/aetherblog/ai/client/config/AiServiceProperties.java:22;apps/server/aetherblog-ai/ai-client/src/main/resources/application-ai.yml:4;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/controller/SystemMonitorController.java:105,
AIOB-030,P0,4,backend,校正 ai_usage_logs 结构与历史回填一致性,核对迁移执行状态并补齐缺失迁移与幂等回填，修复字段长度、token 与 cost 历史数据一致性。,迁移版本对齐且可重复执行；ai_usage_logs 关键字段无非法空值；抽样校验 token/cost 回填准确；统计不再长期为0。,AUTOSERVER,Review需核查迁移脚本幂等性、回填范围与索引影响，避免全表更新导致长时间锁表。,回归需在含历史数据环境执行迁移演练并比对前后统计结果，确认查询性能无显著回退。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:19;apps/server/aetherblog-app/src/main/resources/db/migration/V2_10__ai_usage_logs.sql:2;apps/server/aetherblog-app/src/main/resources/db/migration/V2_18__enhance_ai_usage_analytics.sql:3;apps/server/aetherblog-app/src/main/resources/db/migration/V2_19__fix_ai_usage_backfill_and_lengths.sql:4;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/repository/AiUsageLogRepository.java:86,
AIOB-040,P0,5,both,增强埋点写入可靠性与可观测追踪,将埋点写入失败从仅 warning 升级为可追踪机制，补齐失败计数、采样明细、告警阈值和请求关联 ID。,埋点失败可被计数并按阈值触发告警；每条失败含 requestId 与 errorCategory；业务成功但埋点失败场景有明确降级语义。,AUTOSERVER,Review需确认告警采样与限流策略，避免日志风暴；埋点失败不应阻断主业务响应。,回归需注入数据库不可写与网络抖动故障，验证降级、计数与告警链路可用。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:20;apps/ai-service/app/api/routes/ai.py:64;apps/ai-service/app/services/usage_logger.py:91;apps/ai-service/app/services/usage_logger.py:114;apps/ai-service/app/api/routes/metrics.py:9,
AIOB-050,P0,6,backend,强化统计与日志接口的错误分层语义,完善聚合查询和日志读取参数边界与返回语义，明确区分“无数据”与“读取失败”，并统一诊断字段。,统计与日志接口在空结果和异常场景返回可区分语义；响应统一包含 traceId 或 errorCategory；分页边界参数有稳定行为。,AUTOSERVER,Review需统一错误码、文案和 HTTP 状态映射，避免前端误把失败当空数据处理。,回归需覆盖参数越界、日志文件不存在、DB 查询异常与鉴权失败，并验证前端可据此展示正确状态。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:21;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/service/StatsService.java:89;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/repository/AiUsageLogRepository.java:86;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/service/LogViewerService.java:61;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/controller/SystemMonitorController.java:105,
AIOB-060,P1,7,frontend,改造管理面板显式降级与重试体验,移除无感空 Mock 静默兜底，落地可感知降级态、一键重试、最后成功时间与诊断提示。,AI 看板与最近日志在失败场景显示明确降级态；支持一键重试；显示最后成功时间；恢复后状态自动回正。,AUTOFRONTEND,Review需确认不再默认写入 MOCK 数据掩盖故障；错误文案、按钮行为与 loading 态一致。,回归需覆盖 API 非200、超时、网络错误和恢复重连，确认用户可区分“暂无数据”与“系统异常”。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:22;apps/admin/src/pages/dashboard/DashboardPage.tsx:162;apps/admin/src/pages/dashboard/components/RealtimeLogViewer.tsx:60;apps/admin/src/services/systemService.ts:239,
AIOB-070,P0,8,both,补齐后端、AI 服务与前端分层测试,新增集成测试、路由测试和前端契约回归，覆盖正常、空数据、异常、鉴权失败四类关键路径。,新增测试用例覆盖四类路径；后端迁移+查询集成测试可稳定通过；关键页面回归用例纳入默认验证流程。,AUTOE2E,Review需确认测试数据构造可重复、无环境偶发性，且失败信息可直接定位到链路节点。,回归需在 CI 与本地各执行至少1次全链路测试，结果一致且无新增不稳定用例。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:23;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/service/StatsService.java:89;apps/ai-service/app/api/routes/metrics.py:9;apps/admin/src/pages/dashboard/DashboardPage.tsx:149,
AIOB-080,P1,9,both,建立发布前置检查与灰度回滚策略,增加 preflight 检查脚本并定义灰度发布与回滚开关，保障异常可快速止损。,preflight 覆盖迁移版本、关键 API、权限与日志可读性；灰度策略可执行并具备回滚路径；发布演练至少完成1次。,AUTOE2E,Review需确认 preflight 失败即阻断发布，且输出项可直接映射到责任模块。,回归需在灰度环境演练“发布-观测-回滚”闭环并记录耗时与操作步骤。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:24;apps/server/aetherblog-ai/ai-client/src/main/resources/application-ai.yml:4;apps/server/aetherblog-service/blog-service/src/main/java/com/aetherblog/blog/controller/SystemMonitorController.java:105;apps/server/aetherblog-app/src/main/resources/db/migration/V2_19__fix_ai_usage_backfill_and_lengths.sql:4,
AIOB-090,P1,10,both,执行发布后 24h 观测与问题闭环,定义监控面板与告警阈值，按小时复核关键指标并沉淀复盘和长期治理项。,发布后24小时内完成按小时巡检记录；错误率、空数据占比、埋点成功率均有趋势图与阈值；复盘清单可追踪。,AUTOE2E,Review需确认监控指标与告警阈值与基线一致，避免只监控“有无报错”而忽略数据失真。,回归需对比发布前后同口径指标，确认无静默失败回归并输出治理待办。,未开始,未开始,未开始,未提交,,plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:25;plan/2026-02-13_17-14-53-ai-analytics-logging-observability-fix.md:27;apps/ai-service/app/api/routes/metrics.py:9;apps/admin/src/pages/dashboard/DashboardPage.tsx:149,
